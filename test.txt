try {
      data = StringUtil.replace(" ", "\r\n", data);
      byte[] dataByte = data.getBytes("ISO-8859-1");
      bais = new ByteArrayInputStream(dataByte);
      type = ("word".equals(type)) ? "doc" : type;
      String strType = CEImgTypeSingle.getInstance().getName(type);
      response.setContentType(strType);
      is = MimeUtility.decode(bais, "base64");
      os = response.getOutputStream();
      byte[] ba = new byte[1024];
      int iLen = 0;
      while ((iLen = is.read(ba)) > 0) {
        os.write(ba, 0, iLen);
      }
      os.flush();
      os.close();
      is.close();
      bais.close();
    }
